%
require-network

:sock ~0 variable ,;

:buffer ~1024 dalloc [,] ,;

:send ^sock @ socket-send drop ,;
:send-nl ^10 sock @ socket-send-char drop ,;
:recv ~( buffer -) ^1024 sock @ socket-recv drop ,;

:main ^
   ~c" 127.0.0.1" ^8000 client-start .s sock !

   buffer recv buffer prn
   buffer recv buffer prn

   ~c" Hello from client!" ^send send-nl

   ^1 sleep

   sock @ server-stop drop
   .s
,;

~main
bye
